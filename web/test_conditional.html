<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conditional Dropdown Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        select, button {
            width: 100%;
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            margin-top: 20px;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        #result {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f9f9f9;
            display: none;
        }
    </style>
</head>
<body>
    <h1>Visualization of Metrics</h1>
    <form id="visualizationForm">
	
        <div class="form-group">
            <label for="category">Metric Category:</label>
            <select id="category" name="category">
                <option value="">Select Category</option>
                <option value="data_quality">Data Quality</option>
                <option value="ai_model">AI Model</option>
                <option value="detection_limits">Detection Limits</option>
            </select>
        </div>

        <div class="form-group" id="data_quality_setSelect" style="display:none;">
            <label for="data_quality">Data Quality Set:</label>
            <select id="data_quality" name="data_quality">
                <option value="">Select Data Set</option>
                <option value="set1">set1</option>
                <option value="set2">set2</option>
                <option value="set3">set3</option>
				<option value="set4">set4</option>
                <option value="set5">set5</option>
                <option value="set6">set6</option>
		
            </select>
        </div>

        <div class="form-group" id="data_quality_vistypeSelect" style="display:none;">
            <label for="data_quality_vis">Visualization Type:</label>
            <select id="data_quality_vis" name="data_quality_vis">
                <option value="">Select Vis Type</option>
                <option value="2d">2D scatter</option>
                <option value="3d">3D surface</option>
            </select>
        </div>
	<!--	
		<div class="form-group" id="data_quality_setSelect" style="display:none;">
            <label for="data_quality">Data Quality Metric Type:</label>
            <select id="data_quality" name="data_quality">
                <option value="">Select Data Quality Metric</option>
                <option value="snr1">SNR1</option>
                <option value="snr2">SNR2</option>
                <option value="snr3">SNR3</option>
				<option value="snr4">SNR4</option>
                <option value="snr5">SNR5</option>
                <option value="snr6">SNR6</option>
                <option value="Michelson_contrast">Michelson_contrast</option>
                <option value="RMS_contrast">RMS_contrast</option>
				<option value="SSIM">SSIM</option>
                <option value="PSNR">PSNR</option>
                <option value="Edge_density">Edge_density</option>
				<option value="MI">Mutual Information</option>
                <option value="NMI">Normalized MI</option>
                <option value="CE">Cross_Entropy</option>		
				<option value="Foreground_mean">Foreground_mean</option>
                <option value="Background_mean">Background_mean</option>
                <option value="Foreground_var">Foreground_var</option>
                <option value="Background_var">Background_var</option>
                <option value="Mean_intensity">Mean_intensity</option>
                <option value="Std_intensity">Std_intensity</option>
				<option value="Variance_intensity">Variance_intensity</option>
		
            </select>
        </div>
		-->

        <div class="form-group" id="ai_model_idSelect" style="display:none;">
            <label for="ai_model">AI Model ID:</label>
            <select id="ai_model" name="ai_model">
                <option value="">Select AI Model</option>
                <option value="3">ID3</option>
                <option value="5">ID5</option>
                <option value="7">ID7</option>
            </select>
        </div>

        <div class="form-group" id="ai_model_vistypeSelect" style="display:none;">
            <label for="ai_model_vis">Visualization Type:</label>
            <select id="ai_model_vis" name="ai_model_vis">
                <option value="">Select Vis Type</option>
                <option value="2d">2D scatter</option>
                <option value="3d">3D surface</option>
            </select>
        </div>

        <div class="form-group" id="detection_limits_idSelect" style="display:none;">
            <label for="detection_limits">AI Model ID:</label>
            <select id="detection_limits" name="detection_limits">
			    <option value="">Select AI Model</option>
                <option value="3">ID3</option>
                <option value="5">ID5</option>
                <option value="7">ID7</option>

            </select>
        </div>


        <button type="submit">Submit Request</button>
        <BR>
         <p><input value="submit" onclick="showResults()" type="submit"></p>
        <BR>
        <p><input value="Explain Metrics" onclick="showMetricInfo()" type="submit"></p>
        <BR>
        <div id="metric_description"></div>
    </form>

    <div id="result"></div>

    <script>
        const METRICDESCRIPTION= [
            {abbreviation: "Foreground_mean", longName: "Average pixel intensity in the foreground region"},
            {abbreviation: "Background_mean", longName: "Average pixel intensity in the background region"},
            {abbreviation: "Foreground_var", longName: "Variance of pixel intensities in the foreground region"},
            {abbreviation: "Background_var", longName: "Variance of pixel intensities in the background region"},
            {abbreviation: "Mean_intensity", longName: "Average intensity across the entire image"},
            {abbreviation: "Std_intensity", longName: "Standard deviation of intensities across the image"},
            {abbreviation: "Variance_intensity", longName: "Variance of intensities across the image"},
            {abbreviation: "Michelson_contrast", longName: "Contrast measure defined as (Imax-Imin)/(Imax+Imin)"},
            {abbreviation: "RMS_contrast", longName: "Root Mean Square contrast measure"},
            {abbreviation: "SSIM", longName: "Structural Similarity Index Measure"},
            {abbreviation: "PSNR", longName: "Peak Signal-to-Noise Ratio"},
            {abbreviation: "Edge_density", longName: "Density of edges detected in the image"},
            {abbreviation: "MI", longName: "Mutual Information between image regions"},
            {abbreviation: "NMI", longName: "Normalized Mutual Information"},
            {abbreviation: "CE", longName: "Cross Entropy between image distributions"},
            { abbreviation: "SNR_power_est", longName: "Signal-to-Noise Ratio Power Estimate" },
            { abbreviation: "SNR_RMSpower_est", longName: "Signal-to-Noise Ratio RMS Power Estimate" },
            { abbreviation: "SNR_invCV2_est", longName: "Signal-to-Noise Ratio Inverse CV² Estimate" },
            { abbreviation: "SNR_invCV_est", longName: "Signal-to-Noise Ratio Inverse CV Estimate" },
            { abbreviation: "SNR_invCV_param", longName: "Signal-to-Noise Ratio Inverse CV Parameter" },
            { abbreviation: "SNR_invCV2_param", longName: "Signal-to-Noise Ratio Inverse CV² Parameter" },
            { abbreviation: "SNR_power_param", longName: "Signal-to-Noise Ratio Power Parameter" },
            { abbreviation: "SNR_RMSpower_param", longName: "Signal-to-Noise Ratio RMS Power Parameter" },
            { abbreviation: "Cohend_est", longName: "Cohen's d Estimate" },
            { abbreviation: "Cohend_param", longName: "Cohen's d Parameter" },
        ];
        const QUALITYMETRICS = [
            "SNR_power_est",
            "SNR_RMSpower_est",
            "SNR_invCV2_est",
            "SNR_invCV_est",
            "SNR_invCV_param",
            "SNR_invCV2_param",
            "SNR_power_param",
            "SNR_RMSpower_param",
            "Cohend_est",
            "Cohend_param",
             "Foreground_mean",
            "Background_mean",
            "Foreground_var",
            "Background_var",
            "Mean_intensity",
            "Std_intensity",
            "Variance_intensity",
            "Michelson_contrast",
            "RMS_contrast",
            "SSIM",
            "PSNR",
            "Edge_density",
            "MI",
            "NMI",
            "CE",
            ];

        // // Metric descriptions
        // const metricInfo = {
        //         "Foreground_mean": "Average pixel intensity in the foreground region",
        //         "Background_mean": "Average pixel intensity in the background region",
        //         "Foreground_var": "Variance of pixel intensities in the foreground region",
        //         "Background_var": "Variance of pixel intensities in the background region",
        //         "Mean_intensity": "Average intensity across the entire image",
        //         "Std_intensity": "Standard deviation of intensities across the image",
        //         "Variance_intensity": "Variance of intensities across the image",
        //         "Michelson_contrast": "Contrast measure defined as (Imax-Imin)/(Imax+Imin)",
        //         "RMS_contrast": "Root Mean Square contrast measure",
        //         "SSIM": "Structural Similarity Index Measure",
        //         "PSNR": "Peak Signal-to-Noise Ratio",
        //         "Edge_density": "Density of edges detected in the image",
        //         "MI": "Mutual Information between image regions",
        //         "NMI": "Normalized Mutual Information",
        //         "CE": "Cross Entropy between image distributions"
        //     };

        document.addEventListener('DOMContentLoaded', function() {
            // Get all form elements
            const form = document.getElementById('visualizationForm');
			//const vis_dimcategorySelect = document.getElementById('vis_dimcategory');
						
            const categorySelect = document.getElementById('category');
			
            const data_qualitySelect = document.getElementById('data_quality');
            const ai_modelSelect = document.getElementById('ai_model');
            const detection_limitsSelect = document.getElementById('detection_limits');
			            
            const data_quality_setSelect = document.getElementById('data_quality_setSelect');
            const ai_model_idSelect = document.getElementById('ai_model_idSelect');
            const detection_limits_idSelect = document.getElementById('detection_limits_idSelect');

            const data_quality_vistypeSelect = document.getElementById('data_quality_vistypeSelect');
            const ai_model_vistypeSelect = document.getElementById('ai_model_vistypeSelect');


            const resultDiv = document.getElementById('result');

			
			// Visualization Dimensionality Category change event
            // vis_dimcategorySelect.addEventListener('change', function() {
            //     const selectedVal = vis_dimcategorySelect.value;
            //     if (selectedVal) {
            //         formData.vis_dimcategoryType = selectedVal;
			// 		const description = metricInfo[selectedVal] || "No description available";
            //         resultDiv.innerHTML = `
            //             <h3>${selectedMetric}</h3>
            //             <p>${description}</p>
            //         `;
            //         resultDiv.style.display = 'block';
            //     } else {
            //         resultDiv.innerHTML = "<p>Please select a metric first</p>";
            //         resultDiv.style.display = 'block';
            //     }
            // });
            //

            // Category change event
            categorySelect.addEventListener('change', function() {
                // Hide all groups first
                data_quality_setSelect.style.display = 'none';
                ai_model_idSelect.style.display = 'none';
                detection_limits_idSelect.style.display = 'none';

                data_quality_vistypeSelect.style.display = 'none';
                ai_model_vistypeSelect.style.display = 'none';

                // Reset all selects
                data_qualitySelect.value = '';
                ai_modelSelect.value = '';
                detection_limitsSelect.value = '';

                data_quality_vistypeSelect.value = '';
                ai_model_vistypeSelect.value ='';

                // Show relevant group based on selection
                switch(this.value) {
                    case 'data_quality':
                        data_quality_setSelect.style.display = 'block';
                        break;
                    case 'ai_model':
                        ai_model_idSelect.style.display = 'block';
                        break;
                    case 'detection_limits':
                        detection_limits_idSelect.style.display = 'block';
                        break;
                }
            });

            // Data Quality change event
            data_qualitySelect.addEventListener('change', function() {
                console.log('INSIDE of data_qualitySelect:', this.value)
                // Hide sub-categories
                //data_quality_setSelect.style.display = 'none';
                ai_model_idSelect.style.display = 'none';
				detection_limits_idSelect.style.display = 'none';

                data_quality_vistypeSelect.style.display = 'none';
                ai_model_vistypeSelect.style.display = 'none';

                // Reset values
                //data_qualitySelect.value = '';
                ai_modelSelect.value = '';
				detection_limitsSelect.value = '';
                data_quality_vistypeSelect.value = '';
                ai_model_vistypeSelect.value ='';
                
                // Show relevant group based on selection
                switch(this.value) {
                    case 'set1':
                        data_quality_setSelect.style.display = 'block';
                        data_quality_vistypeSelect.style.display = 'block';
                        break;
                    case 'set2':
                        data_quality_setSelect.style.display = 'block';
                        data_quality_vistypeSelect.style.display = 'block';
                        break;
                    case 'set3':
                        data_quality_setSelect.style.display = 'block';
                        data_quality_vistypeSelect.style.display = 'block';
                        break;
                    case 'set4':
                        data_quality_setSelect.style.display = 'block';
                        data_quality_vistypeSelect.style.display = 'block';
                        break;
                    case 'set5':
                        data_quality_setSelect.style.display = 'block';
                        data_quality_vistypeSelect.style.display = 'block';
                        break;
                    case 'set6':
                        data_quality_setSelect.style.display = 'block';
                        data_quality_vistypeSelect.style.display = 'block';
                        break;
                }
            });
			
			// AI Model change event
            ai_modelSelect.addEventListener('change', function() {
                console.log('INSIDE of ai_modelSelect:', this.value)
                // Hide sub-categories
                data_quality_setSelect.style.display = 'none';
                //ai_model_idSelect.style.display = 'none';
				detection_limits_idSelect.style.display = 'none';

                data_quality_vistypeSelect.style.display = 'none';
                ai_model_vistypeSelect.style.display = 'none';
                
                // Reset values
                data_qualitySelect.value = '';
                //ai_modelSelect.value = '';
				detection_limitsSelect.value = '';
                data_quality_vistypeSelect.value = '';
                ai_model_vistypeSelect.value ='';

                // Show relevant group based on selection
                switch(this.value) {
                    case '3':
                        ai_model_idSelect.style.display = 'block';
                        ai_model_vistypeSelect.style.display = 'block';
                        break;
                    case '5':
                        ai_model_idSelect.style.display = 'block';
                        ai_model_vistypeSelect.style.display = 'block';
                        break;
                    case '7':
                        ai_model_idSelect.style.display = 'block';
                        ai_model_vistypeSelect.style.display = 'block';
                        break;
                }
            });
		
			// Detection Limits change event
            detection_limitsSelect.addEventListener('change', function() {
                // Hide sub-categories
                data_quality_setSelect.style.display = 'none';
                ai_model_idSelect.style.display = 'none';
				//detection_limits_idSelect.style.display = 'none';
                data_quality_vistypeSelect.style.display = 'none';
                ai_model_vistypeSelect.style.display = 'none';

                // Reset values
                data_qualitySelect.value = '';
                ai_modelSelect.value = '';
				//detection_limitsSelect.value = '';
                data_quality_vistypeSelect.value = '';
                ai_model_vistypeSelect.value ='';

                // Show relevant group based on selection
                switch(this.value) {
                    case '3':
                         detection_limits_idSelect.style.display = 'block';
                        break;
                    case '5':
                         detection_limits_idSelect.style.display = 'block';
                        break;
                    case '7':
                         detection_limits_idSelect.style.display = 'block';
                        break;

                }
            });		

            // Data quality visualization typechange event
            data_quality_vistypeSelect.addEventListener('change', function() {
                console.log('INSIDE of data_quality_vistypeSelect:', this.value)

                // const test = document.getElementById('data_quality_vis');
                // console.info('Selected value:', test.value);
                // console.log('test:', test.getAttributeNames());
                // console.log('Value immediately after change:', this.value);
                // console.log('Options available:', data_quality_vistypeSelect.options);
                // console.log('Selected index:', data_quality_vistypeSelect.selectedIndex);
                //console.log('Selected value:', data_quality_vistypeSelect.options[data_quality_vistypeSelect.selectedIndex]?.value);

                // Hide sub-categories
                //data_quality_setSelect.style.display = 'none';
                ai_model_idSelect.style.display = 'none';
				detection_limits_idSelect.style.display = 'none';

                //data_quality_vistypeSelect.style.display = 'none';
                ai_model_vistypeSelect.style.display = 'none';

                // Reset values
                //data_qualitySelect.value = '';
                ai_modelSelect.value = '';
				detection_limitsSelect.value = '';
                //data_quality_vistypeSelect.value = '';
                ai_model_vistypeSelect.value ='';

                // Show relevant group based on selection
                switch(this.value) {
                    case '2d':
                        data_quality_setSelect.style.display = 'block';
                        data_quality_vistypeSelect.style.display = 'block';
                        break;
                    case '3d':
                        data_quality_setSelect.style.display = 'block';
                        data_quality_vistypeSelect.style.display = 'block';
                        break;
                }
            });

            // AI Model visualization typechange event
            ai_model_vistypeSelect.addEventListener('change', function() {
                // Hide sub-categories
                data_quality_setSelect.style.display = 'none';
                //ai_model_idSelect.style.display = 'none';
				detection_limits_idSelect.style.display = 'none';

                data_quality_vistypeSelect.style.display = 'none';
                //ai_model_vistypeSelect.style.display = 'none';

                // Reset values
                data_qualitySelect.value = '';
                //ai_modelSelect.value = '';
				detection_limitsSelect.value = '';
                data_quality_vistypeSelect.value = '';
                //ai_model_vistypeSelect.value ='';

                // Show relevant group based on selection
                switch(this.value) {
                    case '2d':
                        ai_model_idSelect.style.display = 'block';
                        ai_model_vistypeSelect.style.display = 'block';
                        break;
                    case '3d':
                        ai_model_idSelect.style.display = 'block';
                        ai_model_vistypeSelect.style.display = 'block';
                        break;

                }
            });


            // Form submission
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Collect form data
                const formData = {
					//vis_dimcategory: vis_dimcategory.value,
                    category: categorySelect.value
                };

                // Add subcategory data based on category
                if (formData.category === 'data_quality') {
                    formData.data_qualityType = data_qualitySelect.value;

                    const data_quality_vis= document.getElementById('data_quality_vis');
                    console.info('assign to form  Selected value:', data_quality_vis.value);
                    formData.data_quality_visType = data_quality_vis.value;

                } else if (formData.category === 'ai_model') {
                    formData.ai_modelType = ai_modelSelect.value;

                    const ai_model_vis= document.getElementById('ai_model_vis');
                    console.info('assign to form  Selected value:', ai_model_vis.value);
                    formData.ai_model_visType = ai_model_vis.value;
					
                } else if (formData.category === 'detection_limits') {
                    formData.detection_limitsType = detection_limitsSelect.value;
                }
                
                // Display the result
                resultDiv.innerHTML = '<h3>Form Submission Data:</h3><pre>' + 
                                     JSON.stringify(formData, null, 2) + '</pre>';
                resultDiv.style.display = 'block';
                
                // In a real application, you would send this data to a server
                console.log('Form data to submit:', formData);

            });
        });

        function showResults(){

            var categorySelect = document.getElementById('category').value;

            var data_qualitySelect = document.getElementById('data_quality').value;
            var ai_modelSelect = document.getElementById('ai_model').value;
            var detection_limitsSelect = document.getElementById('detection_limits').value;

            var data_quality_setSelect = document.getElementById('data_quality_setSelect').value;
            var ai_model_idSelect = document.getElementById('ai_model_idSelect').value;
            var detection_limits_idSelect = document.getElementById('detection_limits_idSelect').value;

            //var data_quality_vistypeSelect = document.getElementById('data_quality_vistypeSelect');
            var data_quality_vistypeSelect= document.getElementById('data_quality_vis').value;
            var ai_model_vistypeSelect = document.getElementById('ai_model_vis').value;


            console.log('test_conditional: ' + categorySelect + ", " + data_qualitySelect + ", " + ai_modelSelect + ", " + detection_limitsSelect);
            console.log(data_quality_setSelect + ", " + ai_model_idSelect + ", " + data_quality_vistypeSelect + ", " + ai_model_vistypeSelect + "," + detection_limits_idSelect);

            var paramName =`Category&${categorySelect}&DataQuality&${data_qualitySelect}&AIModel&${ai_modelSelect}&DetectionLimit&${detection_limitsSelect}&DataSet&${data_quality_setSelect}&AIModelID&${ai_model_idSelect}&DataVis&${data_quality_vistypeSelect}&AIMModelVis&${ai_model_vistypeSelect}&DetectionID&${detection_limits_idSelect}`;
            showTargetImg(paramName)

            //  var path_to_figures ='';
            // if (data_qualitySelect !== "undefined" &&  data_quality_setSelect !== "undefined" && data_quality_vistypeSelect !== "undefined") {
            //     path_to_figures = 'Images/'+data_quality_setSelect+'_graphs/';
            // }
            //
            // if (ai_modelSelect !== "undefined" &&  ai_model_idSelect !== "undefined" && ai_model_vistypeSelect !== "undefined") {
            //     path_to_figures = 'Images/'+ai_model_vistypeSelect+'_ai'+ai_model_idSelect+'_model/';
            // }
            //
            // if ( detection_limitsSelect !== "undefined"  && detection_limits_idSelect !== "undefined") {
            //     path_to_figures = 'Images/3d_ai'+detection_limits_idSelect+'_model/3d_relation/';
            // }
            //
            //
            // if (path_to_figures !== '' ){
            //   var paramName =`Category&${categorySelect}&DataQuality&${data_qualitySelect}&AIModel&${ai_modelSelect}&DetectionLimit&${detection_limitsSelect}&DataSet&${data_quality_setSelect}&AIModelID&${ai_model_idSelect}&DataVis&${data_quality_vistypeSelect}&AIMModelVis&${ai_model_vistypeSelect}&DetectionID&${detection_limits_idSelect}`;
            //   showTargetImg(paramName)
            // }
            console.log("index.html: PLEASE, MAKE THE SELECTION FROM THE DROP-DOWN MENU");
          };

          function showTargetImg(paramName){
            console.log("paramName=" + paramName);
            window.location.href = 'index_showSEMFigures.html' + '#' + paramName;
            console.log("index_showSEMFigures.html " + '#' + paramName);
          };

          function showMetricInfo(){
              var metricInforText = '';
              for (let i = 0; i< METRICDESCRIPTION.length; i++){
                    var shortName = METRICDESCRIPTION[i].abbreviation;
                    var longName = METRICDESCRIPTION[i].longName;
                    metricInforText += `<br>
                        Metric Abbreviation: ${shortName}<br>
                        Metric Description = ${longName}<br>
                        `;
              }
              console.log("DEBIG: metricInforText=", metricInforText);

              // Add metadata text
            const metadataText = document.createElement('div');
            metadataText.className = 'metadata';
            metadataText.innerHTML = metricInforText;
            // `<strong>Date:</strong> ${image.date}<br>   <strong>Category:</strong> ${image.category}`;
            metadataText.style.fontSize = '12px';
            metadataText.style.color = '#666';


            console.log("About to append metadata");
            document.getElementById("metric_description").appendChild(metadataText);
            console.log("Metadata appended");

            //container.appendChild(metadataText);

            // document.getElementById("metric_description").innerHTML = metricInforText;


          };

    </script>
</body>
</html>


